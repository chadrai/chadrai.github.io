<!doctypehtml><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><link href=https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css rel=stylesheet><link href=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-wcIxkf4k55AIcd1mbVBIA39IMfxPZcr1abSmHoyCCZnwBFRdpCGIy8fOdrHlTfkV><script src=https://cdn.jsdelivr.net/npm/marked/marked.min.js></script><script src=https://cdn.jsdelivr.net/npm/dompurify@3.0.11/dist/purify.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js></script><script src=https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.js crossorigin=anonymous integrity=sha384-hIoBPJpTUs74ddyc4bFZSM1gAUAANpGnvtRjpUkFJQNh3AUYoBG2XP7C/qRdyEKg></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/contrib/auto-render.min.js crossorigin=anonymous integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR></script><style>*{margin:0;padding:0;box-sizing:border-box}body,html{height:100%;overflow:hidden}body{background-color:#101012;color:#fff;font-family:sans-serif;display:flex;flex-direction:column}.custom-scrollbar::-webkit-scrollbar{width:6px}.custom-scrollbar::-webkit-scrollbar-track{background:0 0}.custom-scrollbar::-webkit-scrollbar-thumb{background:rgba(255,255,255,.2);border-radius:3px}.custom-scrollbar::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.4)}.custom-scrollbar::-webkit-scrollbar-thumb:active{background:rgba(255,255,255,.6)}.no-scrollbar{scrollbar-width:none}nav{position:absolute;top:0;left:0;padding:15px;z-index:10}#nav-options{display:flex;align-items:center;gap:15px}.nav-item{background:#282a2c;border:none;border-radius:50px;color:#a2a9b0;cursor:pointer;font-weight:700;font-size:14px;white-space:nowrap;height:36px;display:inline-flex;align-items:center;padding:0 12px}.nav-item:hover{background-color:#3a3a3c}.nav-item.active-green{background-color:#2ecc71;color:#0e0e0f;border-color:#2ecc71}.nav-button-group{display:flex;gap:10px}#open-source-toggle-btn,#save-history-btn{font-size:27px;padding:0 14px;line-height:1;display:inline-flex;align-items:center;justify-content:center;height:36px}.dropdown{position:relative;display:inline-block}.dropdown-content{display:none;position:absolute;background-color:#1b1b1e;min-width:160px;box-shadow:0 8px 16px 0 rgba(0,0,0,.2);z-index:1;border-radius:8px;padding:5px 0;margin-top:5px}.dropdown-content a{color:#fff;padding:10px 15px;text-decoration:none;display:block;font-size:14px}.dropdown-content a:hover{background-color:#5d5cde}.dropdown-content a.selected{background-color:#4a49b3}#api-input-container{display:flex;align-items:center;border-radius:50px;padding:0 10px;background:#282a2c;font-weight:700;color:#a2a9b0;gap:6px;height:36px}#api-input-container span{font-size:14px;padding-right:0;line-height:1}#api-number-input{background:0 0;border:none;color:#a2a9b0;font-weight:700;width:46px;padding:0;font-size:14px;text-align:center;line-height:1}#api-number-input:focus{outline:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.main-content-wrapper{flex-grow:1;display:flex;flex-direction:column;width:100%;margin:0 auto;max-width:800px;overflow:hidden;padding-top:20px}#chat-window{flex-grow:1;overflow-y:auto}#chat-content{max-width:800px;margin:0 auto;padding:20px;display:flex;flex-direction:column;gap:15px}.message{max-width:85%;word-wrap:break-word}.user-message{align-self:flex-end;background-color:#5d5cde;padding:12px 8px;border-radius:10px;white-space:pre-wrap}.ai-message{align-self:flex-start;width:fit-content;max-width:85%;background-color:#1b1b1e;padding:12px;border-radius:12px;white-space:normal}.ai-message.thinking{color:#bbb;background:0 0;padding:10px 0}.ai-message.error{color:#f55;background:0 0;padding:10px 0}.system-message{align-self:center;max-width:95%;color:#f8d27c;opacity:.9;font-style:italic;background:rgba(248,210,124,.08);padding:8px 12px;border-radius:10px;white-space:pre-wrap}.ai-message *{max-width:100%}.ai-message p{margin-bottom:.8em}.ai-message p:last-child{margin-bottom:0}.ai-message a{color:#8ab4f8;text-decoration:none}.ai-message a:hover{text-decoration:underline}.ai-message strong{font-weight:700}.ai-message em{font-style:italic}.ai-message ol,.ai-message ul{margin-left:1.5em;margin-bottom:.8em}.ai-message li{margin-bottom:.4em}.ai-message blockquote{border-left:3px solid #4a4a4c;padding-left:1em;margin-left:0;margin-bottom:.8em;color:#ccc}.ai-message pre{border-radius:8px;margin-bottom:1em;line-height:1.4;position:relative}.ai-message code:not(pre>code){font-family:monospace;background:rgba(255,255,255,.1);padding:.2em .4em;border-radius:4px;font-size:85%}.ai-message pre code{font-size:inherit;padding:1em!important}.ai-message table{width:100%;border-collapse:collapse;margin-bottom:1em;overflow-x:auto;display:block}.ai-message td,.ai-message th{border:1px solid #4a4a4c;padding:8px 12px;text-align:left}.ai-message th{background-color:rgba(255,255,255,.05);font-weight:700}.ai-message tr:nth-child(2n){background-color:rgba(255,255,255,.02)}.input-area{display:flex;align-items:flex-end;padding:10px 15px 20px 15px;gap:10px;flex-shrink:0}.textarea-container{flex-grow:1;position:relative;border:2px solid #4a5050;border-radius:10px;background:#1b1b1e}#message-input{width:100%;background:0 0;border:none;color:#fff;padding:12px;font-family:sans-serif;resize:none;font-size:17px;line-height:1.35;min-height:calc(1.5em + 24px);max-height:calc(1.5em * 5 + 24px);overflow:hidden}#message-input.scrollable{overflow-y:auto}#message-input:focus{outline:0}#message-input::-webkit-scrollbar{width:6px}#message-input::-webkit-scrollbar-track{background:0 0;border-radius:2px}#message-input::-webkit-scrollbar-thumb{background:rgba(255,255,255,.1);border-radius:2px}#message-input::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.3)}#message-input::-webkit-scrollbar-thumb:active{background:rgba(255,255,255,.5)}.scroll-indicator{position:absolute;right:2px;top:12px;bottom:12px;width:2px;background:rgba(255,255,255,.1);border-radius:1px;opacity:0}.scroll-indicator.visible{opacity:1}.scroll-progress{width:100%;background:rgba(93,92,222,.6);border-radius:1px}#send-btn{background-color:#5d5cde;border:none;color:#fff;width:48px;height:48px;border-radius:50%;font-size:24px;cursor:pointer;flex-shrink:0}#send-btn:hover{background-color:#4a49b3}.context-menu{position:fixed;z-index:10001;background:#1b1b1e;color:#fff;border:1px solid rgba(255,255,255,.15);border-radius:8px;padding:6px;display:none;box-shadow:0 6px 18px rgba(0,0,0,.35);min-width:160px}.context-menu button{width:100%;text-align:left;background:0 0;border:none;color:#fff;padding:10px 12px;font-size:14px;border-radius:6px;cursor:pointer}.context-menu button:hover{background:#3a3a3c}@media (min-width:821px){.message{max-width:100%;width:100%}.ai-message,.user-message{align-self:initial}#main-nav{height:100%;width:auto}#nav-options{flex-direction:column;align-items:flex-start}.main-content-wrapper{padding-top:0}.dropdown-content{left:100%;top:0;margin-top:0;margin-left:5px}#chat-window{position:fixed;left:0;right:0;top:0;bottom:var(--chat-bottom-offset,0);overflow-y:auto;-webkit-overflow-scrolling:touch;scrollbar-gutter:stable both-edges;z-index:1}#chat-window{scrollbar-width:auto;scrollbar-color:rgba(255,255,255,.35) transparent}#chat-window::-webkit-scrollbar{width:12px}#chat-window::-webkit-scrollbar-track{background:0 0}#chat-window::-webkit-scrollbar-thumb{background:rgba(255,255,255,.35);border-radius:6px}#chat-window::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.5)}.input-area{position:fixed;left:50%;transform:translateX(-50%);bottom:0;width:100%;max-width:800px;z-index:2;background:linear-gradient(to top,#101012 40%,rgba(16,16,18,.85) 75%,rgba(16,16,18,0))}}@media (max-width:820px){body{position:relative}nav{position:static;width:100%;padding:10px 12px}#nav-options{justify-content:center;flex-wrap:wrap;gap:8px}.main-content-wrapper{max-width:100%;padding-top:0}#api-input-container{padding:0 8px;gap:4px;height:32px;border-radius:50px}#api-input-container span{font-size:12px;letter-spacing:.1px}#api-number-input{width:38px;font-size:12px}.nav-item{font-size:12px;border-radius:50px;height:32px;padding:0 10px}#open-source-toggle-btn,#save-history-btn{font-size:24px;padding:0 12px;height:32px}#chat-content{padding:20px 8px 20px 13px;gap:15px}.message{max-width:100%}}@media (max-width:600px){.nav-item{font-size:12px;padding:0 8px}#api-input-container span{font-size:12px}#api-number-input{width:36px;font-size:12px}#message-input{font-size:17px}.message{max-width:100%}.input-area{padding:10px 12px}}</style><nav id=main-nav><div id=nav-options><div class=dropdown><button id=model-btn class=nav-item>Gemini-2.5-Pro</button><div class=dropdown-content id=model-dropdown-content></div></div><div id=conditional-options-container></div><div id=api-input-container><span class=api-label>API</span><input id=api-number-input inputmode=numeric max=6 min=1 placeholder=(1-31) type=number value=1></div><div class=nav-button-group><button id=save-history-btn class=nav-item>⿻</button><button id=open-source-toggle-btn class=nav-item>&lt;/></button></div></div></nav><div class=main-content-wrapper><div class=custom-scrollbar id=chat-window><div class=chat-content id=chat-content></div></div><div class=input-area><div class=textarea-container><textarea class=custom-scrollbar id=message-input placeholder=Message rows=1></textarea><div class=scroll-indicator><div class=scroll-progress></div></div></div><button id=send-btn>➤</button></div></div><div class=context-menu id=message-context-menu aria-hidden=true role=menu><button id=copy-message-btn role=menuitem>⿻ Copy message</button></div><script>document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("chat-window"),t=document.getElementById("chat-content"),n=document.getElementById("message-input"),o=document.getElementById("send-btn"),s=document.querySelector(".scroll-indicator"),i=document.querySelector(".scroll-progress"),a=document.getElementById("model-btn"),r=document.getElementById("model-dropdown-content"),l=document.getElementById("conditional-options-container"),c=document.getElementById("api-number-input"),d=document.querySelector("#api-input-container .api-label"),u=document.getElementById("save-history-btn"),m=document.getElementById("open-source-toggle-btn"),h=document.getElementById("message-context-menu"),g=document.getElementById("copy-message-btn");let p=null;const f={1:"96o7pzkaeGPT7kEZIMwVJNSYwp8AtdRncs0gibIp6ZI",2:"j-25Sajyw1WLiON-P_tguz_YqyRxOtKAr7EvRHVg27M",3:"DyvTHJIU4tjPEFrkqJMytrGEBwWrjHADu-sLWOqn1Ro",4:"05m45xbvPuCDt9ujI-HrJnLfoCWlMgHr2NeVk7mQDng",5:"6E0sJ50nnI29bWTF7MjsXkzelOnK1IvjL-IJ_hDmGrg",6:"dxJzND66xcU6X2uIaZHbj2tiACyy3RHZdOYyyV9uXmE",7:"b3olBJWY-Z81J0_Z8EZ7B4v_ALS-CaqyqB2Y7n1aE44",8:"izIoQ-e6itj8-AGBw5XCgkaEnYOlRw7lMy3i02B4LG8",9:"zCH2uU2Zh6tkgttn2jhjApaFDD9NvitbqjhPWFIgWvA",10:"hTTzA1dxvDzgHu167rGyuB8ygIgJ0SxGmp4G6IcoiqE",11:"jYHTWDrpC8jNP-XI43vY6bLp1m1Py1jYdr3apETw4hg",12:"X3w3aGXt3ExFz9c_rO7EXPtPXaBZXOcIR-2CCDOlzIY",13:"93nvOcJ6x3qhD0QlvWoU6sdETljirGaUyFSPIPTBc3Y",14:"f3gCf1sWqFPRiUqtioN_SiQFqdeP3XBBtzhKQZ2mHz0",15:"wsv6ezM9YVo4b9lor_FFyspfHqU3LNWHo0uf1tWiaaE",16:"xJeKQY_ovlZUncbdeufYtnUr-5pR36PlJU1-FVrG-FA",17:"1YRBsnYx9SPJ1oLuBvdFPkDcOvmeaFpeftt2Qn3cO2w",18:"L_VuYuWAPZ_Al74_UJy71359I0in59AxdBu8Lh44NQs",19:"VGFdPSil5LkcQ2aetYoWkJryOGtBtyfXlG-j4u-pmfI",20:"-cG66M6Yo0xpCbViqzzmwEzIv-yjMSFzrHJ2Hzv72_w",21:"9j-JX7A1Ou4rnzGzurwoVR1veTeove7r6wTIUfxkv5E",22:"OTBFrP4lW1JZXvivj_ogC4jsKadyPz-L9fPYr3tpcbQ",23:"bt910_-J0xWl4XsJs5iL4ehKA5uEmoTF9y-_aasrAeY",24:"JoVqgzhFOl-z0oJoNIEkrJoj9syLeoFIyHZWgc39dFI",25:"vCet9WgSs2FBW9FjzBk_ifw0VB9kKVNlGLepD9ap30U",26:"6ucDNEY4qPFhTYDcAWquxA1pLjAzyd26X062PuiBoZs",27:"bcDaS9BVFJBfCkFe6hz9z8OrI0twf-QR60FJeLr_2pE",28:"XbmrC_IklPTq2DZQiDoMXdtDxPWl1EzlapEp4lUAeuk",29:"7Cndpcyz_K8DlPviAL0rHirSCL48ZTLsfCosvAvaCaQ",30:"uodRJeJ7qYEaA2sRC3o6-6xkK1RqEJ6scWVKcsd6IzI",31:"34BhYlCl6hK6fKb8bljn6Fv2wIzwiktwwuVtvwzwFyE"},y=["Gemini-2.5-Pro","GPT-5","o4-mini","o3","GPT-4o-Search","Claude-Sonnet-4","Claude-Sonnet-4-Reasoning","Claude-Sonnet-4-Search","Grok-4"],v={"Gemini-2.5-Pro":{shortName:"Gemini 2.5 Pro",hasOptions:!0,options:["8192","32768"],default:"8192",suffixMap:{8192:"--thinking_budget 8192",32768:"--thinking_budget 32768"}},"GPT-5":{shortName:"GPT 5",hasOptions:!0,options:["minimal","high"],default:"high",suffixMap:{minimal:"--reasoning_effort minimal",high:"--reasoning_effort high"}},"o4-mini":{shortName:"OpenAI o4 mini",hasOptions:!1,defaultSuffix:"--reasoning_effort high"},o3:{shortName:"OpenAI o3",hasOptions:!1,defaultSuffix:"--reasoning_effort high"},"GPT-4o-Search":{shortName:"GPT 4o Search",hasOptions:!1,defaultSuffix:"--reasoning_effort high"},"Claude-Sonnet-4":{shortName:"Sonnet 4",hasOptions:!0,options:["0","30768"],default:"30768",suffixMap:{0:"--thinking_budget 0",30768:"--thinking_budget 30768"}},"Claude-Sonnet-4-Reasoning":{shortName:"Sonnet 4 Reason",hasOptions:!0,options:["16348","61440"],default:"61440",suffixMap:{16348:"--thinking_budget 16348",61440:"--thinking_budget 61440"}},"Claude-Sonnet-4-Search":{shortName:"Sonnet 4 Search",hasOptions:!0,options:["8192","126000"],default:"126000",suffixMap:{8192:"--thinking_budget 8192",126e3:"--thinking_budget 126000"}},"Grok-4":{shortName:"Grok 4"}};let L=y[0],E=null,x=[],b=!1,k=!0;function w(){localStorage.setItem("lastUsedApiId",c.value),localStorage.setItem("lastUsedModel",L),E&&localStorage.setItem("lastUsedModelOption_"+L,E)}function C(e){l.innerHTML="";const t=v[e];if(t&&t.hasOptions){const n=localStorage.getItem("lastUsedModelOption_"+e)||t.default;E=n;const o=document.createElement("div");o.className="dropdown";const s=document.createElement("button");s.className="nav-item",s.id="conditional-btn",s.textContent=E;const i=document.createElement("div");i.className="dropdown-content",t.options.forEach((e=>{const t=document.createElement("a");t.href="#",t.textContent=e,e===E&&t.classList.add("selected"),t.addEventListener("click",(n=>{n.preventDefault(),E=e,s.textContent=e,i.querySelectorAll("a").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),J(),w()})),i.appendChild(t)})),o.appendChild(s),o.appendChild(i),l.appendChild(o)}else E=null}let I=!1;function S(){try{const t=document.querySelector(".input-area");if(!t||!e)return;if(!window.matchMedia("(min-width: 821px)").matches)return e.style.removeProperty("--chat-bottom-offset"),void(e.style.paddingBottom="0px");const n=t.getBoundingClientRect().height||0;e.style.setProperty("--chat-bottom-offset",n+"px"),e.style.paddingBottom=n+20+"px"}catch(e){}}function T(){const e=5*parseFloat(getComputedStyle(n).lineHeight)+24;function t(){n.scrollHeight>e?(n.style.height=e+"px",n.classList.add("scrollable"),s.classList.add("visible"),o()):(n.style.height="auto",n.style.height=n.scrollHeight+"px",n.classList.remove("scrollable"),s.classList.remove("visible")),S()}function o(){const e=n.scrollTop,t=n.scrollHeight,o=n.clientHeight,s=t-o;if(s>0){const n=e/s,a=Math.max(10,o/t*100),r=n*(100-a);i.style.height=a+"%",i.style.transform=`translateY(${r}%)`}}I||(n.addEventListener("input",t),n.addEventListener("scroll",o),I=!0),t()}function P(e){return v[e]?.shortName||e}function A(e,t){if(!t)return void(e.innerHTML="");const n=marked.parse(t,{breaks:!0,gfm:!0});e.innerHTML=DOMPurify.sanitize(n);try{Prism.highlightAllUnder(e)}catch(e){console.error("PrismJS error:",e)}try{renderMathInElement(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"[",right:"]",display:!0}],throwOnError:!1})}catch(e){console.error("KaTeX error:",e)}}function O(n,o){const s=document.createElement("div");return s.classList.add("message"),"user"===o?(s.classList.add("user-message"),s.textContent=n):"ai"===o||"assistant"===o?(s.classList.add("ai-message"),A(s,n)):"system"===o&&(s.classList.add("system-message"),s.textContent=n),t.appendChild(s),k&&(e.scrollTop=e.scrollHeight),s}function B(){n.value="",n.style.height="auto",n.classList.remove("scrollable"),s.classList.remove("visible"),T()}async function z({apiKey:e,apiId:t,model:n,messages:o,onChunk:s,onComplete:i,onError:a}){try{const r=await fetch("https://api.poe.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`},body:JSON.stringify({model:n,messages:o,stream:!0})});if(!r.ok){const e=(await r.json().catch((()=>null)))?.error?.message||r.statusText||"Unknown API error",n=[401,402,403,429,500,502,503,504].includes(r.status)||["quota","limit","exceeded","capacity","overloaded","payment","unauthorized","invalid api key"].some((t=>e.toLowerCase().includes(t)));return void a({success:!1,rotatable:n,message:`API${t}: ${e}`})}const l=r.body.getReader(),c=new TextDecoder("utf-8");let d="",u="";for(;;){const{done:t,value:n}=await l.read();if(t)break;d+=c.decode(n,{stream:!0});const o=d.split("\n");d=o.pop();for(const t of o){if(""===t.trim()||!t.startsWith("data: "))continue;const n=t.substring(6);if("[DONE]"===n.trim())return void i(u);try{const e=JSON.parse(n).choices?.[0]?.delta?.content||"";e&&(u+=e,s(e))}catch(e){}}}i(u)}catch(e){a({success:!1,rotatable:!0,message:`API${t}: ${e?.message||"Kesalahan jaringan"}`})}}async function M(t,n,o,s=!0){const i=function(e){const t=Object.keys(f).map((e=>Number(e))).filter((e=>!Number.isNaN(e))).sort(((e,t)=>e-t)).map((e=>String(e)));if(0===t.length)return[];const n=String(e),o=t.indexOf(n);return-1===o?t.slice():t.slice(o).concat(t.slice(0,o))}(String(c.value||""));if(0===i.length)return o.textContent="[ERROR] Tidak ada API key yang terdaftar.",o.classList.remove("thinking"),void o.classList.add("error");let a="",r=!1;const l=t=>{r||(o.textContent="",o.classList.remove("thinking"),r=!0,a+=t,A(o,a),k&&(e.scrollTop=e.scrollHeight))},d=e=>{let t=e;if(t.length%2==0){const e=t.length/2;t.substring(0,e)===t.substring(e)&&(t=t.substring(0,e))}a=t,A(o,a),s&&x.push({role:"assistant",content:a}),w()};for(const s of i){const i=f[s];if(!i)continue;c.value=s,r||(o.textContent=`Calling API ${s}`,k&&(e.scrollTop=e.scrollHeight));let u=null;const m=e=>{u=e};if(await new Promise((e=>{z({apiKey:i,apiId:s,model:n,messages:t,onChunk:l,onComplete:t=>{d(t),e()},onError:t=>{m(t),e()}})})),!u)return;if(a="",A(o,""),!u.rotatable)return o.textContent="[ERROR] "+u.message,o.classList.remove("thinking"),void o.classList.add("error")}r||(o.textContent="All APIs were limited",o.classList.remove("thinking"),o.classList.add("error"),k&&(e.scrollTop=e.scrollHeight))}function _(e,t,n){p=n,h.style.display="block",h.style.left=e+"px",h.style.top=t+"px",h.setAttribute("aria-hidden","false");const o=h.getBoundingClientRect();let s=o.left,i=o.top;o.right>window.innerWidth-8&&(s=Math.max(8,window.innerWidth-o.width-8)),o.bottom>window.innerHeight-8&&(i=Math.max(8,window.innerHeight-o.height-8)),h.style.left=s+"px",h.style.top=i+"px"}function H(){h.style.display="none",h.setAttribute("aria-hidden","true"),p=null}function J(){document.querySelectorAll(".dropdown-content").forEach((e=>e.style.display="none"))}function N(){window.innerWidth,d.textContent="API"}function D(){const e=n.value.trim();if(""===e)return;const t=L,o=E;if(b){const t=function(e){const t=e.trim();if(t.startsWith("["))try{const e=JSON.parse(t);if(Array.isArray(e)){const t=[];for(const n of e){if(!n||"object"!=typeof n)continue;const e=(n.role||"").toString().toLowerCase(),o=(n.content??"").toString();["system","user","assistant"].includes(e)&&o&&t.push({role:e,content:o})}if(t.length>0)return{ok:!0,messages:t}}}catch(e){}const n=function(e){const t=[];let n=0;const o=e.length;for(;n<o;){for(;n<o&&"{"!==e[n];)n++;if(n>=o)break;let s=1,i=n;n++;let a=!1,r="";for(;n<o&&s>0;){const t=e[n];a?t===r&&"\\"!==e[n-1]&&(a=!1):"{"===t?s++:"}"===t?s--:'"'!==t&&"'"!==t||(a=!0,r=t),n++}if(0!==s)continue;const l=e.substring(i,n),c=l.match(/role\s*:\s*["']?(system|user|assistant)["']?/i);if(!c)continue;const d=c[1].toLowerCase(),u=l.toLowerCase().indexOf("content:");if(-1===u)continue;let m=l.substring(u+8).trim();m.endsWith("}")&&(m=m.substring(0,m.length-1).trim());const h=['"',"'"];h.includes(m[0])&&h.includes(m[m.length-1])?m=m.substring(1,m.length-1):h.includes(m[0])?m=m.substring(1):h.includes(m[m.length-1])&&(m=m.substring(0,m.length-1)),m=m.replace(/\\r/g,"\r").replace(/\\n/g,"\n").replace(/\\"/g,'"').replace(/\\'/g,"'").replace(/\\\//g,"/").replace(/\\\\/g,"\\"),m=m.trim(),m&&["system","user","assistant"].includes(d)&&t.push({role:d,content:m})}return t}(t);return n.length>0?{ok:!0,messages:n}:{ok:!1,error:"FORMAT_TIDAK_VALID"}}(e);if(t.ok){x=t.messages,t.innerHTML="";for(const e of x)O(e.content,e.role);B()}else{const t=e;O(t,"user"),x.push({role:"user",content:t}),B()}return}const{textToSend:s}=function(e,t,n){const o=v[t];let s="";if(o)if(o.hasOptions&&o.suffixMap){const e=o.suffixMap[n];e&&(s=` ${e}`)}else o.defaultSuffix&&(s=` ${o.defaultSuffix}`);return{textToSend:e+s,suffix:s}}(e,t,o);O(s,"user"),x.push({role:"user",content:s}),B();const i=O("","ai");i.classList.add("thinking"),i.textContent="Thinking...",M(x.slice(),t,i,!0)}const j=window.matchMedia("(max-width: 600px)");let F=j.matches;j.addEventListener("change",(e=>{F=e.matches})),n.addEventListener("keydown",(e=>{"Enter"!==e.key||!F&&e.shiftKey||(e.preventDefault(),D())})),o.addEventListener("click",D),u.addEventListener("click",(function(){if(0===x.length)return;const e=[];for(const t of x)["system","user","assistant"].includes(t.role)&&e.push({role:t.role,content:t.content});const t=e.map((e=>`{ role: "${e.role}", content: "${String(e.content).replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\r/g,"\\r").replace(/\n/g,"\\n")}" }`)).join(",\n");navigator.clipboard.writeText(t).catch((()=>{const e=document.createElement("textarea");e.value=t,document.body.appendChild(e),e.select();try{document.execCommand("copy")}catch(e){alert("Gagal menyalin otomatis. Salin manual:\n\n"+t)}document.body.removeChild(e)}))})),m.addEventListener("click",(function(){const e=b;if(b=!b,b)m.classList.add("active-green"),n.placeholder='Open Source Mode -- tempel daftar pesan ({ role: "...", content: "..." }) atau ketik pesan baru';else if(m.classList.remove("active-green"),n.placeholder="Message",e&&x.length>0){const e=x[x.length-1];if(e&&"user"===e.role){const e=O("","ai");e.classList.add("thinking"),e.textContent="Thinking...",M(x.slice(),L,e,!0)}}})),c.addEventListener("change",w),document.addEventListener("click",(e=>{if(e.target.matches(".nav-item")){const t=e.target.parentElement;if(t&&t.classList&&t.classList.contains("dropdown")){const e=t.querySelector(".dropdown-content"),n="block"===e.style.display;J(),n||(e.style.display="block")}}else J()})),function(){const e=localStorage.getItem("lastUsedApiId");e&&(c.value=e);const t=localStorage.getItem("lastUsedModel");t&&y.includes(t)&&(L=t)}(),a.textContent=P(L),r.innerHTML="",y.forEach((e=>{const t=document.createElement("a");t.href="#",t.textContent=e,e===L&&t.classList.add("selected"),t.addEventListener("click",(n=>{n.preventDefault(),L=e,a.textContent=P(e),document.querySelectorAll("#model-dropdown-content a").forEach((e=>e.classList.remove("selected"))),t.classList.add("selected"),C(e),J(),w()})),r.appendChild(t)})),C(L),T(),e.addEventListener("contextmenu",(e=>{if("touch"===e.pointerType||"pen"===e.pointerType)return;const t=e.target.closest(".message");t&&(e.preventDefault(),_(e.clientX,e.clientY,t))})),e.addEventListener("touchstart",(e=>{if(2===e.touches.length){const t=e.target.closest(".message");if(t){e.preventDefault();const n=e.touches[0],o=e.touches[1];_((n.clientX+o.clientX)/2,(n.clientY+o.clientY)/2,t)}}})),g.addEventListener("click",(()=>{if(!p)return;const e=p.innerText||p.textContent||"";navigator.clipboard.writeText(e).catch((()=>{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select();try{document.execCommand("copy")}catch(t){alert("Gagal menyalin otomatis. Salin manual:\n\n"+e)}document.body.removeChild(t)})).finally((()=>{H()}))})),document.addEventListener("click",(e=>{"block"!==h.style.display||h.contains(e.target)||H()})),e.addEventListener("scroll",H),window.addEventListener("resize",H),N(),window.addEventListener("resize",N),S(),window.addEventListener("resize",S),e.addEventListener("scroll",(()=>{k=e.scrollTop+e.clientHeight>=e.scrollHeight-20}))}))</script>
